name: Update Data

on: push

jobs:
  update:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo content
        uses: actions/checkout@v2

      # - name: Setup Bun Runtime
      #   uses: antongolub/action-setup-bun@v1 # or @v1.x.x
      #   with:
      #     # Attach $BUN_INSTALL/install/cache to action/cache
      #     # Optional, defaults to false
      #     cache: true

      #     # actions/tool-cache provides a cache for the current job only
      #     # Use actions/cache to store the bun binary for the whole workflow
      #     # Optional, defaults to false
      #     cache-bin: true

      # - name: Execute Script
      #   run: |
      #     bun install
      #     bun src/index.ts

      # - name: Add File
      #   run: |
      #     git config --local user.email "belummikir@gmail.com"
      #     git config --local user.name "zakiego"
      #     git add .

      # - name: Check is need to push
      #   id: check_status
      #   run: |
      #     STATUS=$(git status --porcelain | wc -l)
      #     echo "number of files that need to be committed:" $STATUS
      #     echo "::set-output name=STATUS::$STATUS"

      # - name: Commit File
      #   if: steps.check_status.outputs.STATUS > 0
      #   run: |
      #     echo "status"
      #     now=$(date)
      #     git commit -m "feat: update data $now"

      # - name: Push Changes
      #   if: steps.check_status.outputs.STATUS > 0
      #   uses: ad-m/github-push-action@master
      #   with:
      #     github_token: ${{ secrets.GITHUB_TOKEN }}
      #     branch: ${{ github.ref }}

      - name: Setup Python
        uses: actions/setup-python@v4

      - name: Push to Google Sheets
        if: steps.check_status.outputs.STATUS > 0
        run: |
          pip install pandas
          python src/push.py ${{ secrets.CREDENTIALS }}
